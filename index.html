<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>증여세 계산기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .calculator {
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 400px;
            padding: 20px;
            text-align: center;
        }

        .calculator h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .calculator label {
            display: block;
            margin-bottom: 5px;
            text-align: left;
            font-weight: bold;
        }

        .calculator input, .calculator select, .calculator button {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .calculator button {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
            border: none;
            cursor: pointer;
        }

        .calculator button:hover {
            background-color: #45a049;
        }

        #result {
            font-size: 16px;
            color: #333;
            margin-top: 15px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1 id="title">증여세 계산기 (2024년 기준)</h1>
        <form id="taxForm">
            <label for="giftAmount" id="label-giftAmount">증여 금액 (원):</label>
            <input type="text" id="giftAmount" placeholder="예: 100,000,000" required>

            <label for="relationship" id="label-relationship">관계:</label>
            <select id="relationship">
                <option value="50000000">직계비속(자녀) - 공제 한도: 50,000,000원</option>
                <option value="600000000">배우자 - 공제 한도: 600,000,000원</option>
                <option value="500000">며느리/사위 - 공제 한도: 500,000원</option>
                <option value="10000000">타인, 친구, 친인척 등 - 공제 한도: 10,000,000원</option>
            </select>
            <p>타인, 친구, 친인척 등: 법적 또는 혈연 관계에 명시되지 않은 모든 사람을 포함합니다.</p>

            <label for="previousGift" id="label-previousGift">과거 증여 금액 (원):</label>
            <input type="text" id="previousGift" placeholder="예: 20,000,000">

            <button type="submit" id="button-calculate">계산하기</button>
        </form>

        <div id="result"></div>
    </div>

    <script>
        const taxBrackets = [
            { limit: 100000000, rate: 10, deduction: 0 },
            { limit: 500000000, rate: 20, deduction: 10000000 },
            { limit: 1000000000, rate: 30, deduction: 60000000 },
            { limit: 3000000000, rate: 40, deduction: 160000000 },
            { limit: Infinity, rate: 50, deduction: 460000000 }
        ];

        function getExemptionLimit(relationship) {
            if (relationship.includes("직계비속(자녀)")) return { exemption: 50000000, period: 10 };
            if (relationship.includes("배우자")) return { exemption: 600000000, period: 10 };
            if (relationship.includes("며느리/사위")) return { exemption: 500000, period: 5 };
            if (relationship.includes("타인, 친구, 친인척 등")) return { exemption: 10000000, period: 0 };
            return { exemption: 0, period: 0 }; // 기본값
        }

        document.getElementById('taxForm').onsubmit = function (e) {
            e.preventDefault();

            const relationship = document.getElementById('relationship').options[document.getElementById('relationship').selectedIndex].text;
            const { exemption, period } = getExemptionLimit(relationship);

            const giftAmount = parseInt(document.getElementById('giftAmount').value.replace(/,/g, '')) || 0;
            const previousGift = parseInt(document.getElementById('previousGift').value.replace(/,/g, '')) || 0;

            const totalTaxable = period > 0
                ? Math.max(giftAmount + previousGift - exemption, 0)
                : Math.max(giftAmount - exemption, 0);

            let tax = 0;
            for (let bracket of taxBrackets) {
                if (totalTaxable > bracket.limit) {
                    tax += (bracket.limit - (taxBrackets[taxBrackets.indexOf(bracket) - 1]?.limit || 0)) * (bracket.rate / 100);
                } else {
                    tax += (totalTaxable - (taxBrackets[taxBrackets.indexOf(bracket) - 1]?.limit || 0)) * (bracket.rate / 100);
                    tax -= bracket.deduction;
                    break;
                }
            }

            document.getElementById('result').innerText = `최종 증여세액은 ${Math.max(tax, 0).toLocaleString()}원입니다.`;
        };

        // 입력 필드에 쉼표 추가 기능
        function formatNumberInput(inputElement) {
            const value = inputElement.value.replace(/,/g, '');
            if (!isNaN(value) && value !== '') {
                inputElement.value = parseInt(value, 10).toLocaleString();
            } else {
                inputElement.value = '';
            }
        }

        document.getElementById('giftAmount').addEventListener('input', function () {
            formatNumberInput(this);
        });

        document.getElementById('previousGift').addEventListener('input', function () {
            formatNumberInput(this);
        });
    </script>
</body>
</html>
